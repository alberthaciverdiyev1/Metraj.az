<div class="container text-[13px] mx-auto pt-10 pl-5">
{{>Component.Breadcrumb items=breadcrumbs}}
</div>

{{>Component.ScrollTop}}

<style>
.thumbnails::-webkit-scrollbar {
    display: none;
}
.thumbnails {
    -ms-overflow-style: none;  
    scrollbar-width: none;     
}
.thumbnails img {
    opacity: 0.5;
    transition: opacity 0.2s;
}
.thumbnails img.active {
    opacity: 1;  
    ring: 2px solid #3b82f6; 
}

.gallery-thumbnails {
    display: grid !important;
    gap: 0.5rem;
    overflow: hidden;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    max-width: 100%;
}


</style>

<div class="container mx-auto px-4 mt-12">
    <section id="listing-detail-gallery">
        <div class="container mx-auto px-4">
            <div class="gallery-grid">
                {{!-- {{#if (lookup property.media.images 0)}} --}}
                    {{!-- {{#with (lookup property.media.images 0)}} --}}
                        <div class="gallery-main">
                            {{!-- <img src="{{this.path}}" alt="Əsas şəkil" class="w-full h-auto object-cover rounded"> --}}
                            <div id="map" class="w-full h-[500px] rounded-lg mb-6 z-0"></div>
                            <a href="https://www.google.com/maps/place/Baku/@40.394737,49.6901458,11z/data=!3m1!4b1!4m6!3m5!1s0x40307d6bd6211cf9:0x343f6b5e7ae56c6b!8m2!3d40.4092617!4d49.8670924!16zL20vMDFnZjU?entry=ttu&g_ep=EgoyMDI1MDgzMC4wIKXMDSoASAFQAw%3D%3D" 
                            target="_blank"
                            class="absolute w-full bottom-0  text-center px-6 py-3 border border-[#F1913D] text-[#F1913D] font-semibold rounded-full shadow-md bg-white z-10">Show on maps</a>
                        </div>
                    {{!-- {{/with}} --}}
                {{!-- {{/if}} --}}
                
                <div class="gallery-thumbnails">
                    {{#each property.media.images}}
                        {{!-- {{#if (gt @index 0)}} --}}
                            {{#if (lt @index 3)}}
                                <figure class="m-0 overflow-hidden cursor-pointer rounded"
                                        onclick="openModal({{@index}})">
                                    <img src="{{this.path}}" alt="Kiçik şəkil" class="w-full h-24 object-cover">
                                </figure>
                            {{/if}} 
                        {{!-- {{/if}} --}}
                    {{/each}}
                    
                    {{#if (gt property.media.images.length 3)}}
                        <div class="more-images-overlay w-32 h-32 flex items-center justify-center bg-black bg-opacity-50 text-white text-xl font-bold rounded-lg cursor-pointer">
                           <span>+{{math property.media.images.length "-" 5}} şəkil</span>
                        </div>
                    {{/if}}
                </div>
            </div>
        </div>
    </section>
</div>



<div id="modal" class="modal">
    <div class="modal-header">
        <span id="counter">1/{{property.media.images.length}}</span>
        <div class="modal-actions">
            <button onclick="toggleFullscreen()"><i class="bi bi-fullscreen"></i></button>
            <button onclick="closeModal()"><i class="bi bi-x-lg"></i></button>
        </div>
    </div>

    <div class="modal-navigation">
        <button onclick="prevImage()"><i class="bi bi-arrow-left"></i></button>
        <img id="modal-image" src="" alt="Modal Image">
        <button onclick="nextImage()"><i class="bi bi-arrow-right"></i></button>
    </div>

    <div class="thumbnails mt-4 flex space-x-2 overflow-x-auto" id="thumbnails">
        {{#each property.media.images}}
            <img src="{{this.path}}" onclick="openModal({{@index}})" class="w-20 h-20 object-cover rounded cursor-pointer hover:ring-2 hover:ring-blue-500">
        {{/each}}
    </div>
</div>

<section id="side">
    <div class="container mx-auto px-4">
        <div class="side-left">
    <div class="info-box">
        <!-- Başlıq və qiymətlər -->
        <div class="info-box-title mb-4 flex flex-col sm:flex-row sm:items-center sm:gap-4">
            <!-- Əsas başlıq -->
            <h2 class="text-xl sm:text-2xl font-semibold break-words">
                {{ property.title }}
            </h2>

            <!-- Qiymətlər -->
            <div class="flex flex-wrap gap-2 mt-2 sm:mt-0">
                {{#each property.prices}}
                    <h2 class="text-lg sm:text-xl font-semibold whitespace-nowrap">
                        ₼{{ this.price }} <span class="text-sm font-normal">/month</span>
                    </h2>
                {{/each}}
            </div>
        </div>

                    <div class="info-box-desc">
                        <div class="left">
                            <div class="adress">
                                <i class="bi bi-geo-alt me-2"></i>
                                <span>{{ property.address }}</span>
                            </div>
                        </div>
                         <div class="right flex items-center !flex-row flex-wrap gap-3 md:gap-4 text-lg md:text-xl">
                            <i class="bi bi-heart cursor-pointer"></i>
                            <i class="bi bi-arrow-left-right cursor-pointer"></i>
                            <i class="bi bi-printer cursor-pointer" id="printBtn"></i>
                            <i class="bi bi-share cursor-pointer"></i>
                        </div>
                    </div>
                </div>

                {{>Component.Property.Specs item=property}}

                {{#if property.media.video}}
                    {{#each property.media.video}}
                        <section id="video" class="video-section">
                            <div class="video-container">
                                <video id="video-frame" controls>
                                    <source src="{{this.path}}" type="video/mp4">
                                </video>
                                <div class="play-button" id="toggle-btn">
                                    <i class="bi bi-play-fill" id="play-icon"></i>
                                    <i class="bi bi-pause-fill d-none" id="pause-icon"></i>
                                </div>
                            </div>
                        </section>
                    {{/each}}
                {{/if}}

                {{>Component.Property.Features features=property.features column=3}}
                {{>Component.Property.NearbyObjects objects = property.nearby column=3}}
                {{>Component.Property.Map location=property.location zoom=15}}

                

                {{#if property.media.document}}
                    <div class="attachment-box">
                        <h2>File Attachments</h2>
                        <div class="file-list">
                            {{#each property.media.document}}
                                <div class="file-item">
                                    <div class="file-icon">
                                        <i class="fa-regular fa-file fa-2x"></i>
                                        <span>PDF</span>
                                    </div>
                                    <div class="file-name">Document {{@index}}</div>
                                    <div class="download-icon">
                                        <a href="{{ this.path}}" download>
                                            <i class="bi bi-download"></i>
                                        </a>
                                    </div>
                                </div>
                            {{/each}}
                        </div>
                    </div>
                {{/if}}

                {{>Component.Property.VirtualTour tour=property.virtual_tour}}
                <div class="loan-calculator-container" style="width: 100%;">
                    {{>Component.LoanCalculator}}
                </div>
                {{>Component.SimilarCards currentProperty=property}}
                <a href="/?page=1&limit=20" class="lg:w-[300px] w-full mt-10 text-center px-6 py-3 border flex flex-nowrap border-[#F1913D] text-[#F1913D] font-semibold rounded-full shadow-md bg-white">Daha çox oxşar elanlar</a>
            </div>
            
            <div class="side-right">
                <div class="sticky">
                    <div class="contact-card">
                        <h3>Contact Sellers</h3>
                        <div class="flex avatar-info">
                            <img src="https://themesflat.co/html/proty/images/avatar/seller.jpg" alt="Shara Conner" class="avatar">
                            <div class="avatar-info-text">
                                <h4>Shara Conner</h4>
                                <div id="phone-numbers-container"></div>
                                {{#if setting.email}}
                                    <p><a href="mailto:{{setting.email}}" class="email">
                                        <i class="bi bi-envelope"></i> {{setting.email}}</a></p>
                                {{/if}}
                            </div>
                        </div>

                        <form id="contact-form">
                            <button class="send-message-btn all-btn button-hover" type="button" id="call-button">Zəng et</button>
                        </form>
                    </div>

                    {{> Component.Property.MultiplePhoneModal}}
                    {{> Component.Property.PremiumButtons}}
                    {{> Component.Property.PremiumModal}}
                    {{> Component.Property.MoveForwardModal}}
                </div>
            </div>
        </div>

        {{!-- {{>Component.ConnectAgent}} --}}
    </div>
</section>
 <!--  <section id="location">
  <div class="container mx-auto px-4">
    <div class="bg-white rounded-xl p-4 shadow-md w-full max-w-[900px] relative z-0">
        <h1 class="text-3xl font-semibold mb-4">Get Direction</h1>
        {{!-- <div id="map" class="w-full h-[500px] rounded-lg mb-6"></div> --}}

        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 p-4  max-w-[800px]">
            <ul class="space-y-2">
                <li class="flex justify-between gap-2">
                    <span class="font-semibold">Address</span>
                    <div class="text-gray-700">150 sqft</div>
                </li>
                <li class="flex justify-between gap-2">
                    <span class="font-semibold">City</span>
                    <div class="text-gray-700">#1234</div>
                </li>
                <li class="flex justify-between gap-2">
                    <span class="font-semibold">State/County</span>
                    <div class="text-gray-700">$7,500</div>
                </li>
            </ul>
            <ul class="space-y-2">
                <li class="flex justify-between gap-2">
                    <span class="font-semibold">Postal Code</span>
                    <div class="text-gray-700">7.328</div>
                </li>
                <li class="flex justify-between gap-2">
                    <span class="font-semibold">Area</span>
                    <div class="text-gray-700">7.328</div>
                </li>
                <li class="flex justify-between gap-2">
                    <span class="font-semibold">Country</span>
                    <div class="text-gray-700">2024</div>
                </li>
            </ul>
        </div>
    </div>
  </div>
</section> -->



<script>
    const imagesData = [
        {{#each property.media.images}}
            "{{this.path}}",
        {{/each}}
    ];
</script>

{{js 'phone-modal.js'}}
{{js 'videoplay.js'}}
{{js 'image-gallery.js'}}
{{js 'modal.js'}}
{{js 'map-find-adress.js'}}
<script src="/js/helpers/numberFormat.js" defer></script>
